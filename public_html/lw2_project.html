<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <!-- Main stylesheet -->
  <link rel="stylesheet" href="./css/main.css">

  <title>CS354: Programming Languages (Spring 2021) - Team Perch</title>
</head>

<body>
  <div class="jumbotron text-left">
    <img src="assets/ruby.png" height="100">
    <h5>CS 354: Programming Languages (Spring 2021)</h5>
  </div>
  <nav class="navbar navbar-expand-sm bg-dark navbar-dark">
    <a class="navbar-brand" href="#">Team Perch</a>
    <ul class="navbar-nav">
      <li class="navbar-item"><a class="nav-link" href="index.html">Home&nbsp;&nbsp;|</a></li>
      <li class="navbar-item"><a class="nav-link" href="documentation.html">Documentation&nbsp;&nbsp;|</a></li>
      <li class="navbar-item"><a class="nav-link" href="installation.html">Installation&nbsp;&nbsp;|</a></li>
      <li class="navbar-item"><a class="nav-link" href="comparisons.html">Language Comparisons&nbsp;&nbsp;|</a></li>
      <li class="navbar-item"><a class="nav-link" href="examples.html">Code Examples&nbsp;&nbsp;|</a></li>
      <li class="navbar-item"><a class="nav-link" href="lw2_project.html">CSV Parser Project</a></li>
    </ul>
  </nav>
  <div class="container" style="margin-top:30px">
    <h3>Purpose</h3>
    <p>
      Create a simple script to parse and aggregate data from a CSV file.
    </p>
    <h3>Implementation</h3>
    <p>
      To accomplish our goal, two classes were created along with an execution script.
    </p>
    <ul>
      <li><a href="#PrintInventory">PrintInventory.rb</a>&nbsp;&#8211;&nbsp;execution script</li>
      <li><a href="#ReadCSV">ReadCSV.rb</a>&nbsp;&#8211;&nbsp;class for reading CSV and populating data structure</li>
      <li><a href="#Item">Item.rb</a>&nbsp;&#8211;&nbsp;class with defines an inventory item</li>
    </ul>
    <h3>CSV format</h3>
    <p>
      CSV format for this project is rigid and requires a 'name', 'quantity', and 'price' fields.
    </p>
    <code class="code-output">
  id,name,quantity,price
  1,Mousse - Mango,43,4.27
  2,Bread Foccacia Whole,55,6.3
  3,Beer - Corona,63,6.43
  4,Napkin White - Starched,40,7.32
  5,Remy Red,35,5.9
  6,Compound - Strawberry,48,4.37
  7,Pork Loin Cutlets,95,6.1
  8,"Wine - Red, Gamay Noir",69,4.4
  . . .
    </code>
    <br>
    <h3>Command line execution</h3>
    <code class="code-output">
  $> ruby PrintInventory.rb
  Enter a filename for your inventory: 
  data/grocery.csv
    </code>
    <br>
    <h3>Output</h3>
    <p>
      Displayed below is the truncated output from an input inventory list of 1000 items.
    </p>
    <code class="code-output">
  +------------------------------------------------------------+
  | Inventory list                                             |
  +-----------------------------------------------+----+-------+
  | Mousse - Mango                                | 43 | $4.27 |
  | Bread Foccacia Whole                          | 55 | $6.30 |
  | Beer - Corona                                 | 63 | $6.43 |
  | Napkin White - Starched                       | 40 | $7.32 |
  | Remy Red                                      | 35 | $5.90 |
  
  . . .
  
  | Chocolate Liqueur - Godet White               | 72 | $4.41 |
  | Dawn Professionl Pot And Pan                  | 46 | $3.99 |
  | Table Cloth 54x54 Colour                      | 96 | $5.77 |
  | Aspic - Amber                                 |  9 | $9.71 |
  +-----------------------------------------------+----+-------+
  Total number of unique items in inventory: 1000
  Total number of items warehoused: 50657
  Total value of inventory: $265168.52
    </code>
    <br>
    <h3>Error handling</h3>
    <p>
      The following basic error handling has been incorporated into the ReadCSV.rb class.
    </p>
    <code class="code-output">
  $> ruby PrintInventory.rb
  Enter a filename for your inventory: 
  data/cars.csv
  The provided CSV file is formatted incorrectly.
  Please include the following headers: name, price, quantity.
  
  $> ruby PrintInventory.rb
  Enter a filename for your inventory: 
  data/foo-bar.csv
  ERROR:: file 'data/foo-bar.csv' does not exist. Exiting
  
  $> ruby PrintInventory.rb
  Enter a filename for your inventory: 
  non-readable.csv
  ERROR:: file './non-readable.csv' is not readable. Exiting
    </code>
    <br>
    <h3>Future improvements</h3>
    <ol>
      <li>ETL process for CSV input should be dynamic.</li>
      <li>Custom selection and filtering for field specific data.</li>
      <li>SQLite database is a possible use candidate depending on scale/needs.</li>
      <li>Selectable output format.</li>
    </ol>
    <a class="top" href="#">Return to top</a>
    <br><br>
    <h3>Code</h3>
    <h5><a name="PrintInventory">PrintInventory.rb</a></h5>
    <p>
      PrintInventory.rb is the main script for this project. A ReadCSV object is initialized and referenced to print a summarized inventory list.
    </p>
    <code class="code-example">
  # file: PrintInventory.rb
  # author(s): Ryan Rickerl
  # date: 26 Apr 2021
  # desc: Generates an inventory of 'Items' with a total worth
  require './ReadCSV'
  
  puts "Enter a filename for your inventory: "
  filename = gets.chomp
  
  csvFile = ReadCSV.new(filename)
  
  # print a summary of the inventory
  csvFile.printData
    </code>
    <a class="top" href="#">Return to top</a>
    <br><br>
    <h5><a name="ReadCSV">ReadCSV.rb</a></h5>
    <p>
      ReadCSV.rb is a class which defines a ReadCSV object. During instantiation, CSV data is read from a file and an
      array is populated with inventory 'Item' objects.
    </p>
    <code class="code-example">
  # file: ReadCSV.rb
  # author: Nicolas Dupuis, Ben Davies, Nathan Maroko, Ryan Rickerl
  # date: 4/19/2021
  # desc: Select and Parse a csv file
  
  require 'csv'
  require './Item'
  
  class ReadCSV
      #CSV file to read our shopping cart or inventory should be with the following headers: name, price, quantity
      def initialize(filename)
          # Check file for existence and readability
          if File.exists?(filename)
              if ! File.readable?(filename)
                  puts "ERROR:: file '#{filename}' is not readable. Exiting"
                  exit
              end
          else
              puts "ERROR:: file '#{filename}' does not exist. Exiting"
              exit
          end
  
          @itemList = []
  
          readFile(filename)
      end
  
      def getData()
          return @itemList
      end
  
      def printData()
          printf "+------------------------------------------------------------+\n"
          printf "| Inventory list                                             |\n"
          printf "+-----------------------------------------------+----+-------+\n"
  
          item_count = 0
          items_warehoused = 0
          inventory_value = 0
  
          # print itemList
          for item in @itemList
              name = item.getName
              quantity = item.getQuantity
              price = item.getPrice
  
              printf "| %-45s | %2i | $%0.2f |\n", name, quantity, price
  
              item_count += 1
              items_warehoused += quantity
              inventory_value += quantity * price
          end
  
          printf "+-----------------------------------------------+----+-------+\n"
          printf "Total number of unique items in inventory: %i\n", item_count
          printf "Total number of items warehoused: %i\n", items_warehoused
          printf "Total value of inventory: $%0.2f\n", inventory_value
      end
  
      private
      def readFile(filename)
          @data = CSV.read(filename)
  
          # get the headers
          colNames = @data.shift()
  
          # create variables to store the references to column indexes
          nameIdx = nil
          priceIdx = nil
          quantityIdx = nil
  
          for i in 0..colNames.length
              colId = colNames[i].to_s            # convert to string for comparison
  
              if colId.casecmp?("name")           # ignorecase compare for "name"
                  nameIdx = i
              elsif colId.casecmp?("price")       # ignorecase compare for "price"
                  priceIdx = i
              elsif colId.casecmp?("quantity")    # ignorecase compare for "quantity"
                  quantityIdx = i
              end
          end
  
          if !(nameIdx and priceIdx and quantityIdx)
              puts "The provided CSV file is formatted incorrectly."
              puts "Please include the following headers: name, price, quantity."
              exit
          end
  
          for row in @data
              name = row[nameIdx]
              price = row[priceIdx].to_f
              quantity = row[quantityIdx].to_i
  
              item = Item.new(name, price, quantity)
  
              @itemList.push(item)
          end
      end
  end
    </code>
    <a class="top" href="#">Return to top</a>
    <br><br>
    <h5><a name="Item">Item.rb</a></h5>
    <p>
      Item.rb is a class which defines an inventory item.
    </p>
    <code class="code-example">
  # file: Item.rb
  # author: Nicolas Dupuis, Ben Davies, Nathan Maroko, Ryan Rickerl
  # date: 4/15/2021
  # desc: Defines an Item object that stores a name,price, and quantity
  
  class Item
    # Constructor method (uses initialize)
    def initialize(name, price, quantity)
      if quantity < 0 
        puts("ERROR:: quantity must be greater than 0. Exiting")
        exit
      end
  
      @name = name
      @price = price
      @quantity = quantity
    end
  
    def getQuantity()
      return @quantity
    end
  
    def setQuantity(quantity)
      @quantity = quantity
    end
  
    def getPrice()
      return @price
    end
  
    def setPrice(price)
      @price = price
    end
  
    def getName()
      return @name
    end
  
    def setName(name)
      @name = name
    end
  
    def toString()
      return sprintf("%4i : %-50s : %5.2f", @quantity, @name, @price)
    end  
    
    def compare(item)
        @name == item.name
    end
  end
    </code>
    <a class="top" href="#">Return to top</a>
    <br><br>
  </div> <!-- container -->
</body>
</html>
